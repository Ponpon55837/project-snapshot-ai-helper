請幫我撰寫一支名為 `snapshot.js` 的 Node.js 單檔腳本，用於任意 JavaScript/TypeScript 專案，生成完整專案結構與程式函式快照，並匯出成 Markdown 文件 `snapshot.md`。請確保它具備以下通用功能，並且易於客製：

1. **排除清單設定**

   - 腳本開頭定義一個可編輯的陣列 `EXCLUDES`，列出所有要忽略的檔案或目錄（相對專案根目錄的名稱或路徑片段）。使用者可自由新增或刪除。

2. **檔案掃描**

   - 遞迴尋訪整個專案，搜尋所有副檔名為 `.js`、`.ts`、`.vue`、`.jsx`、`.tsx`（可依需求自行擴充）的檔案。
   - 自動跳過在 `EXCLUDES` 裡設定的路徑或檔案。

3. **程式碼解析（可自訂）**

   - 預設支援兩種解析模式，可根據檔案特性自訂：
     - **Controller 物件模式**：若檔案匯出一個物件（如 `module.exports = { … }` 或 `export default { … }`），只擷取該物件內的方法名稱與簽名，並可抓取上方的單行註解。
     - **Export 函式模式**：對於一般模組或 Vue `<script>`，擷取所有以 `export function`、`export async function` 或 `export const useXxx =` 等形式定義的函式／composable，並可抓取上方的單行註解。
   - 使用者只要在程式中標註或調整對應的正則或檢測邏輯，即可快速替換成自訂解析規則。

4. **目錄樹生成**

   - 以純文字 ASCII 樹狀圖形式顯示整個專案結構，深度與格式均可在程式中設定。

5. **多專案依賴收集**

   - 自動搜尋所有子目錄下名為 `package.json` 的檔案，讀取其 `"name"` 欄位（或根據需要自訂映射），並擷取其中的 `dependencies` 與 `devDependencies`。
   - 輸出格式為：

     ```md
     ## 專案名稱

     ### devDependencies

         "套件A": "版本",
         ...

     ### dependencies

         "套件X": "版本",
         ...
     ```

6. **Markdown 輸出**

   - 統一將結果寫入 `snapshot.md`，結構清晰分段：
     1. `## 專案目錄結構`（樹狀圖）
     2. `## 函式清單`（按檔案分組列出函式與註解）
     3. `## 依賴清單`（按專案分組列出套件版本）

7. **執行環境與相依**
   - 僅使用 Node.js 內建模組（`fs`, `path`），不依賴第三方套件；
   - 在腳本最上方加入 shebang (`#!/usr/bin/env node`)；
   - 支援同步與非同步皆可，自由選擇；
   - 使用者只需放到專案根目錄，執行：
     ```bash
     node snapshot.js
     ```
   - 每個功能區塊都請加上清楚註解，方便使用者按需求開關或修改。

---

請依照上述通用規格，完整生成 `snapshot.js` 或 `snapshot.cjs` 的程式碼，並在註解中標示每個區塊的功能用途。```
